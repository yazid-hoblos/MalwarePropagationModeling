## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
library(igraph)
library(networkD3)
library(dplyr)
library(deSolve)
library(statnet)
library(EpiModel)
library(flextable)
library(GGally)
library(ggraph)
library(igraph)
library(Matrix)
library(network)
library(quanteda)
library(sna)
library(tidygraph)
library(tidyverse)
library(tm)
library(tibble)
library(GA)


## ----eval=F------------------------------------------------------------------------------------------------------------------------------------------------------------
## df = df %>% arrange(substr(df$timeStamp,1,2))
## 
## p=1
## for (i in 2:nrow(df)){
##   if (substr(df$timeStamp[i],1,2) != substr(df$timeStamp[i-1],1,2)){
##     df[p:(i-1),] =df[p:(i-1),] %>% arrange(substr(df$timeStamp[p:(i-1)],12,13))
##     p=i
##   }
## }
## 
## p=1
## for (i in 2:nrow(df)){
##   if (substr(df$timeStamp[i],12,13) != substr(df$timeStamp[i-1],12,13) | (substr(df$timeStamp[i],1,2) != substr(df$timeStamp[i-1],1,2))){
##     df[p:(i-1),] =df[p:(i-1),] %>% arrange(substr(df$timeStamp[p:(i-1)],15,16))
##     p=i
##   }
## }
## 
## p=1
## for (i in 2:nrow(df)){
##   if (substr(df$timeStamp[i],15,16) != substr(df$timeStamp[i-1],15,16) | (substr(df$timeStamp[i],1,2) != substr(df$timeStamp[i-1],1,2)) | substr(df$timeStamp[i],12,13) != substr(df$timeStamp[i-1],12,13)){
##     df[p:(i-1),] =df[p:(i-1),] %>% arrange(substr(df$timeStamp[p:(i-1)],18,19))
##     p=i
##   }
## }


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
?ergmTerm
?network
search.ergmTerms(search='edgecov')
vignette('ergm-term-crossRef')


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
data = read.csv('mutated_df.csv')
net = readRDS(file = "network2.rds")
View(data)
net


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
set.network.attribute(net,'type',as.matrix(new_data$type))
list.network.attributes(net)
net


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
summary(net~edges)

## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
ergm1 = ergm(net~edges)
summary(ergm1)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
mcmc.diagnostics(ergm1)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
fit <- ergm(net~edges,
            control=snctrl(MCMC.interval=1))
summary(fit)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
sim <- simulate(ergm1,nsim=5)
summary(sim)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
attributes(sim)


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
summary(net~edges+edgecov('weight'))


## ----------------------------------------------------------------------------------------------------------------------------------------------------------------------
ergm2 = ergm(net~edges+edgecov('weight'))
summary(ergm2)

